(window.webpackJsonp=window.webpackJsonp||[]).push([[66],{495:function(t,v,_){"use strict";_.r(v);var a=_(14),s=Object(a.a)({},(function(){var t=this,v=t.$createElement,_=t._self._c||v;return _("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[_("h1",{attrs:{id:"性能优化nodejs调优"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#性能优化nodejs调优"}},[t._v("#")]),t._v(" 性能优化Nodejs调优")]),t._v(" "),_("ul",[_("li",[t._v("内存泄漏")]),t._v(" "),_("li",[t._v("压力测试")]),t._v(" "),_("li",[t._v("编码规范")])]),t._v(" "),_("h2",{attrs:{id:"内存泄漏的概念和所造成的影响"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#内存泄漏的概念和所造成的影响"}},[t._v("#")]),t._v(" 内存泄漏的概念和所造成的影响")]),t._v(" "),_("h3",{attrs:{id:"概念"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#概念"}},[t._v("#")]),t._v(" 概念")]),t._v(" "),_("p",[t._v("程序的运行需要内存，只要程序员提出要求，操作系统或者运行时（runtime）就必须供给内存。")]),t._v(" "),_("p",[t._v("对于持续运行的服务进程（deamon），必须及时释放不再用到的内存。否则，内存占用越来越高，轻则影响系统性能，重则导致进程崩溃。不再用到的内存，没有及时释放，就叫做内存泄漏（memoryleak）。")]),t._v(" "),_("p",[t._v("有些语言（比如C语言）必须手动释放内存，程序员负责内存管理。")]),t._v(" "),_("h3",{attrs:{id:"具体表现"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#具体表现"}},[t._v("#")]),t._v(" 具体表现")]),t._v(" "),_("ul",[_("li",[t._v("随着内存泄漏的增长，V8对垃圾收集器越来越具有攻击性，这会使你的应用运行速度变慢。")]),t._v(" "),_("li",[t._v("内存泄漏可能触发其他类型的失败，内存泄漏的代码可能会持续引用有限的资源。你可能会耗尽文件描述符；你还可能会突然不能建立新的数据连接。")]),t._v(" "),_("li",[t._v("你的应用迟早会崩溃，并且在你的应用收到欢迎时肯定会发生。")]),t._v(" "),_("li",[t._v("浏览器端也会发生内存泄漏，只不过浏览器只针对一端，会造成网页卡顿。")])]),t._v(" "),_("h2",{attrs:{id:"压力测试寻找内存泄漏"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#压力测试寻找内存泄漏"}},[t._v("#")]),t._v(" 压力测试寻找内存泄漏")]),t._v(" "),_("h3",{attrs:{id:"压力测试工具"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#压力测试工具"}},[t._v("#")]),t._v(" 压力测试工具")]),t._v(" "),_("h4",{attrs:{id:"wrk"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#wrk"}},[t._v("#")]),t._v(" WRK")]),t._v(" "),_("ul",[_("li",[t._v("-t 需要模拟的线程数")]),t._v(" "),_("li",[t._v("-c 需要模拟的连接数")]),t._v(" "),_("li",[t._v("--timeout 超时的时间")]),t._v(" "),_("li",[t._v("-d 测试的持续时间")]),t._v(" "),_("li",[t._v("./wrk -t12 -c400 -d30s http://127.0.0.1:3000"),_("br"),t._v("\n用12个线程模拟400个链接 在30秒内。一般线程数不宜过多，核数的2到4倍足够。")])]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("项目")]),t._v(" "),_("th",[t._v("名称")]),t._v(" "),_("th",[t._v("说明")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("Avg")]),t._v(" "),_("td",[t._v("平均值")]),t._v(" "),_("td",[t._v("每次测试的平均值")])]),t._v(" "),_("tr",[_("td",[t._v("Stdev")]),t._v(" "),_("td",[t._v("标准偏差")]),t._v(" "),_("td",[t._v("结果离散程度，越高说明越不稳定")])]),t._v(" "),_("tr",[_("td",[t._v("Max")]),t._v(" "),_("td",[t._v("最大值")]),t._v(" "),_("td",[t._v("最大的一次结果")])]),t._v(" "),_("tr",[_("td",[t._v("+/- Stdev")]),t._v(" "),_("td",[t._v("正负一个标准差占比")]),t._v(" "),_("td",[t._v("结果离散程度，越大越不稳定")])])])]),t._v(" "),_("p",[t._v("Latency： 可以理解为响应时间\nReq/Sec：每个线程每秒钟的完成的请求数.")]),t._v(" "),_("div",{staticClass:"custom-block tip"},[_("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),_("p",[t._v("一般我们来说我们主要关注平均值和最大值."),_("br"),t._v("\n标准差如果太大说明样本本身离散程度比较高. 有可能系统性能波动很大")])])])}),[],!1,null,null,null);v.default=s.exports}}]);