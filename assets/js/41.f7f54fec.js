(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{469:function(s,t,n){"use strict";n.r(t);var a=n(14),e=Object(a.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"docker实战"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#docker实战"}},[s._v("#")]),s._v(" Docker实战")]),s._v(" "),n("h2",{attrs:{id:"初始化node程序"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#初始化node程序"}},[s._v("#")]),s._v(" 初始化Node程序")]),s._v(" "),n("p",[s._v("浏览localhost:3000 页面显示 Hello Docker")]),s._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" docker_demo\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" docker_demo\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建文件")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("touch")]),s._v(" server.js\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("touch")]),s._v(" package.json\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("touch")]),s._v(" Dockerfile\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("touch")]),s._v(" .dockerignore\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装koa")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" koa\n")])])]),n("p",[s._v("server.js")]),s._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" Koa "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'koa'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" app "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Koa")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("use")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("async")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("ctx")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n   ctx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("body "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Hello docker'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("listen")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),n("p",[s._v("然后运行")]),s._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("node")]),s._v(" server.js\n")])])]),n("p",[s._v("查看 localhost:3000")]),s._v(" "),n("h2",{attrs:{id:"创建dockerfile文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#创建dockerfile文件"}},[s._v("#")]),s._v(" 创建Dockerfile文件")]),s._v(" "),n("p",[s._v("Dockerfile 是由一系列命令和参数构成的脚本，一个Dockerfile里面包含了整个image的完整命令。Docker通过 docker build 执行Dockerfile 中的一系列命令自动构建image.")]),s._v(" "),n("h4",{attrs:{id:"在-dockerignore-文件里写入代码。表示过滤该类型的文件-类似-gitignore"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#在-dockerignore-文件里写入代码。表示过滤该类型的文件-类似-gitignore"}},[s._v("#")]),s._v(" 在.dockerignore 文件里写入代码。表示过滤该类型的文件，类似.gitignore")]),s._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Log")]),s._v("\nlogs\n*.log\nnpm-debug.log*\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# # Runtime data")]),s._v("\npids\n*.pid\n*.seed\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# # Directory for instrumented libs generated by jscoverage/JSCover")]),s._v("\nlib-cov\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Coverage directory used by tools like istanbul")]),s._v("\ncoverage\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# nyc test coverage")]),s._v("\n.nyc_output\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Grunt intermediate storage (http://gruntjs.com/creating-")]),s._v("\nplugins"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#storing-task-files)")]),s._v("\n.grunt\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# node-waf configuration")]),s._v("\n.lock-wscript\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Compiled binary addons (http://nodejs.org/api/addons.html)")]),s._v("\nbuild/Release\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Dependency directories")]),s._v("\nnode_modules\njspm_packages\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Optional npm cache directory")]),s._v("\n.npm\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Optional REPL history")]),s._v("\n.node_repl_history\n.idea\n.node_modules\nnode_modules\n.vscode\n")])])]),n("h4",{attrs:{id:"在dockerfile写入以下代码"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#在dockerfile写入以下代码"}},[s._v("#")]),s._v(" 在Dockerfile写入以下代码")]),s._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#制定node镜像的版本")]),s._v("\nFROM node:8.9-alpine\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#声明作者")]),s._v("\nMAINTAINER evilboy \n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#移动当前⽬目录下⾯面的⽂文件到app⽬目录下 ")]),s._v("\nADD "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" /app/ \n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#进⼊入到app⽬目录下⾯面，类似cd ")]),s._v("\nWORKDIR /app\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#安装依赖")]),s._v("\nRUN "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#对外暴暴露露的端⼝口")]),s._v("\nEXPOSE "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3000")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#程序启动脚本")]),s._v("\nCMD "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"npm"')]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"start"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n")])])]),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -p 当我们访问当前环境的3001的时候 就等于访问了docker里面的80端口")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -v 映射文件夹及内容到docker，并使之关联。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run --restart always --name centos -p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3001")]),s._v(":80 -v /root/docker:/var/www/docker -itd centos:latest\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入运行的docker 环境")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it centos "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),s._v("\nyum "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" nginx\n")])])]),n("p",[s._v("nginx 配置")]),s._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("server {\n  listen        80;\n  server_name   123.56.121.125\n\n  location / {\n     root  /var/www;\n     index index.html index.htm\n  }\n}\n")])])]),n("p",[s._v("配置nginx并启动 就可以访问了 123.56.121.125:3001")])])}),[],!1,null,null,null);t.default=e.exports}}]);