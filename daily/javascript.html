<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>javascript 每日一题 | Power</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/logo.jpg">
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.6aaf0376.css" as="style"><link rel="preload" href="/assets/js/app.95d8b7d8.js" as="script"><link rel="preload" href="/assets/js/2.78a10e41.js" as="script"><link rel="preload" href="/assets/js/80.5877c75c.js" as="script"><link rel="prefetch" href="/assets/js/10.cfa5e85b.js"><link rel="prefetch" href="/assets/js/11.0c71821e.js"><link rel="prefetch" href="/assets/js/12.f9fa359c.js"><link rel="prefetch" href="/assets/js/13.9e3bc96e.js"><link rel="prefetch" href="/assets/js/14.6c22b46e.js"><link rel="prefetch" href="/assets/js/15.b2fd3990.js"><link rel="prefetch" href="/assets/js/16.7b8fc025.js"><link rel="prefetch" href="/assets/js/17.4f2b29dc.js"><link rel="prefetch" href="/assets/js/18.c0b0262b.js"><link rel="prefetch" href="/assets/js/19.05eebd8e.js"><link rel="prefetch" href="/assets/js/20.b42d2fa7.js"><link rel="prefetch" href="/assets/js/21.bbb426e1.js"><link rel="prefetch" href="/assets/js/22.2c360d85.js"><link rel="prefetch" href="/assets/js/23.4e36e967.js"><link rel="prefetch" href="/assets/js/24.dd2a02bc.js"><link rel="prefetch" href="/assets/js/25.4fdc2c70.js"><link rel="prefetch" href="/assets/js/26.765e5c2f.js"><link rel="prefetch" href="/assets/js/27.0d683c07.js"><link rel="prefetch" href="/assets/js/28.5ae1cf56.js"><link rel="prefetch" href="/assets/js/29.87039c54.js"><link rel="prefetch" href="/assets/js/3.a1e70f10.js"><link rel="prefetch" href="/assets/js/30.0be2db26.js"><link rel="prefetch" href="/assets/js/31.34e0b66f.js"><link rel="prefetch" href="/assets/js/32.d2a36d3f.js"><link rel="prefetch" href="/assets/js/33.c165ff05.js"><link rel="prefetch" href="/assets/js/34.8d58d225.js"><link rel="prefetch" href="/assets/js/35.af8ba47e.js"><link rel="prefetch" href="/assets/js/36.c2856159.js"><link rel="prefetch" href="/assets/js/37.3be4e862.js"><link rel="prefetch" href="/assets/js/38.29365dc5.js"><link rel="prefetch" href="/assets/js/39.0f89d5eb.js"><link rel="prefetch" href="/assets/js/4.a3cab100.js"><link rel="prefetch" href="/assets/js/40.b0de374c.js"><link rel="prefetch" href="/assets/js/41.f7f54fec.js"><link rel="prefetch" href="/assets/js/42.e78a1079.js"><link rel="prefetch" href="/assets/js/43.6a46c288.js"><link rel="prefetch" href="/assets/js/44.0ac61bbb.js"><link rel="prefetch" href="/assets/js/45.51b52846.js"><link rel="prefetch" href="/assets/js/46.bd851090.js"><link rel="prefetch" href="/assets/js/47.49eec2aa.js"><link rel="prefetch" href="/assets/js/48.35d13e78.js"><link rel="prefetch" href="/assets/js/49.7a2d3017.js"><link rel="prefetch" href="/assets/js/5.7dce32d1.js"><link rel="prefetch" href="/assets/js/50.a8442fb9.js"><link rel="prefetch" href="/assets/js/51.97aeb1be.js"><link rel="prefetch" href="/assets/js/52.11e0decf.js"><link rel="prefetch" href="/assets/js/53.122dd2bb.js"><link rel="prefetch" href="/assets/js/54.8b2a6d58.js"><link rel="prefetch" href="/assets/js/55.ab9368bd.js"><link rel="prefetch" href="/assets/js/56.6c6370fb.js"><link rel="prefetch" href="/assets/js/57.1559f8fb.js"><link rel="prefetch" href="/assets/js/58.11795bdc.js"><link rel="prefetch" href="/assets/js/59.aeb14e74.js"><link rel="prefetch" href="/assets/js/6.919d1835.js"><link rel="prefetch" href="/assets/js/60.05a91615.js"><link rel="prefetch" href="/assets/js/61.52485bf1.js"><link rel="prefetch" href="/assets/js/62.e6af1bb7.js"><link rel="prefetch" href="/assets/js/63.ff85734d.js"><link rel="prefetch" href="/assets/js/64.46a5c61e.js"><link rel="prefetch" href="/assets/js/65.43f6a76b.js"><link rel="prefetch" href="/assets/js/66.3d62d4b0.js"><link rel="prefetch" href="/assets/js/67.281b831d.js"><link rel="prefetch" href="/assets/js/68.659c11a7.js"><link rel="prefetch" href="/assets/js/69.df8868a2.js"><link rel="prefetch" href="/assets/js/7.c7943989.js"><link rel="prefetch" href="/assets/js/70.0f15d9b1.js"><link rel="prefetch" href="/assets/js/71.35df2385.js"><link rel="prefetch" href="/assets/js/72.0ec7ebc9.js"><link rel="prefetch" href="/assets/js/73.70276bbf.js"><link rel="prefetch" href="/assets/js/74.44fbc6d2.js"><link rel="prefetch" href="/assets/js/75.45a0f288.js"><link rel="prefetch" href="/assets/js/76.7086c31b.js"><link rel="prefetch" href="/assets/js/77.c800c400.js"><link rel="prefetch" href="/assets/js/78.c803fa26.js"><link rel="prefetch" href="/assets/js/79.16e33e63.js"><link rel="prefetch" href="/assets/js/8.32e33110.js"><link rel="prefetch" href="/assets/js/81.9318e369.js"><link rel="prefetch" href="/assets/js/82.838a9e8f.js"><link rel="prefetch" href="/assets/js/83.3e3b07c0.js"><link rel="prefetch" href="/assets/js/84.7bc28721.js"><link rel="prefetch" href="/assets/js/85.6693c059.js"><link rel="prefetch" href="/assets/js/86.8c466531.js"><link rel="prefetch" href="/assets/js/87.8d67a83f.js"><link rel="prefetch" href="/assets/js/88.e58fe875.js"><link rel="prefetch" href="/assets/js/89.3fff6aee.js"><link rel="prefetch" href="/assets/js/9.a57af53f.js">
    <link rel="stylesheet" href="/assets/css/0.styles.6aaf0376.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Power</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">
  博客
</a></div><div class="nav-item"><a href="/basic/" class="nav-link">
  编程基础
</a></div><div class="nav-item"><a href="/daily/" class="nav-link router-link-active">
  每日一题
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="菜单" class="dropdown-title"><span class="title">更多</span> <span class="arrow down"></span></button> <button type="button" aria-label="菜单" class="mobile-dropdown-title"><span class="title">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          学习相关
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/books/" class="nav-link">
  阅读
</a></li><li class="dropdown-subitem"><a href="/tools/" class="nav-link">
  工具
</a></li></ul></li><li class="dropdown-item"><h4>
          实战
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/practice/" class="nav-link">
  BFF
</a></li><li class="dropdown-subitem"><a href="/blog/css-houdini.html#css-画一片星空" class="nav-link">
  CSS Starry Sky
</a></li></ul></li></ul></div></div> <a href="https://github.com/tengli1990/vuepress" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">
  博客
</a></div><div class="nav-item"><a href="/basic/" class="nav-link">
  编程基础
</a></div><div class="nav-item"><a href="/daily/" class="nav-link router-link-active">
  每日一题
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="菜单" class="dropdown-title"><span class="title">更多</span> <span class="arrow down"></span></button> <button type="button" aria-label="菜单" class="mobile-dropdown-title"><span class="title">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          学习相关
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/books/" class="nav-link">
  阅读
</a></li><li class="dropdown-subitem"><a href="/tools/" class="nav-link">
  工具
</a></li></ul></li><li class="dropdown-item"><h4>
          实战
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/practice/" class="nav-link">
  BFF
</a></li><li class="dropdown-subitem"><a href="/blog/css-houdini.html#css-画一片星空" class="nav-link">
  CSS Starry Sky
</a></li></ul></li></ul></div></div> <a href="https://github.com/tengli1990/vuepress" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/daily/javascript.html" aria-current="page" class="active sidebar-link">javascript</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/daily/javascript.html#_01-项目中如何进行异常捕获" class="sidebar-link">01 项目中如何进行异常捕获？</a></li><li class="sidebar-sub-header"><a href="/daily/javascript.html#_02-比较以下表达式1、2、3大小的结果" class="sidebar-link">02 比较以下表达式1、2、3大小的结果</a></li><li class="sidebar-sub-header"><a href="/daily/javascript.html#_03-javascript中如何模拟实现方法的重载" class="sidebar-link">03 Javascript中如何模拟实现方法的重载</a></li><li class="sidebar-sub-header"><a href="/daily/javascript.html#_04-什么是虚拟dom、作用、定义" class="sidebar-link">04 什么是虚拟DOM、作用、定义？</a></li><li class="sidebar-sub-header"><a href="/daily/javascript.html#_05-javascript-垃圾回收方法" class="sidebar-link">05 javascript 垃圾回收方法</a></li></ul></li><li><a href="/daily/css.html" class="sidebar-link">css</a></li><li><a href="/daily/html.html" class="sidebar-link">html</a></li><li><a href="/daily/vue.html" class="sidebar-link">vue</a></li><li><a href="/daily/engineering.html" class="sidebar-link">工程化</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="javascript-每日一题"><a href="#javascript-每日一题" class="header-anchor">#</a> javascript 每日一题</h1> <h2 id="_01-项目中如何进行异常捕获"><a href="#_01-项目中如何进行异常捕获" class="header-anchor">#</a> 01 项目中如何进行异常捕获？</h2> <details class="custom-block details"><summary>查看解析</summary> <h3 id="代码执行的错误捕获"><a href="#代码执行的错误捕获" class="header-anchor">#</a> 代码执行的错误捕获</h3> <h4 id="_1-try-catch"><a href="#_1-try-catch" class="header-anchor">#</a> 1.try...catch</h4> <ul><li>能捕获到代码执行的错误。</li> <li>捕获不到语法的错误。</li> <li>无法处理异步中的错误。</li> <li>使用try...catch 包裹， 影响代码可读性。</li></ul> <h4 id="_2-window-onerror"><a href="#_2-window-onerror" class="header-anchor">#</a> 2.window.onerror</h4> <ul><li>无论是异步还是非异步错误，<code>onerror</code> 都能捕获到运行时的错误。</li> <li><code>onerror</code> 主要是来捕获预料之外的错误，而 <code>try...catch</code> 则是用来在可预见性行情况下的监控特定的错误，两者结合使用更加高效。</li> <li><code>window.onerror</code> 函数只有在返回true的时候，异常才不会向上抛出，否则即使是知道异常的发生控制台还是会显示 <code>Uncaught Error: xxxx</code> 。</li> <li>当我们遇到 <code>&lt;img src=&quot;./404.png&quot;&gt;</code> 报404网络请求异常的时候，<code>onerror</code> 是无法帮助我们捕获到异常的。</li></ul> <p>监听不到资源加载的报错onerror,事件处理函数只能声明一次，不会重复执行多个回调。</p> <h4 id="window-addeventlistener-error"><a href="#window-addeventlistener-error" class="header-anchor">#</a> window.addEventListener('error')</h4> <p>可以监听到资源加载的报错，也可以注册多个事件处理函数。</p> <div class="language-js extra-class"><pre class="language-js"><code>window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">msg<span class="token punctuation">,</span>url<span class="token punctuation">,</span>row<span class="token punctuation">,</span>col<span class="token punctuation">,</span>error</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span>
</code></pre></div><p>这种方式虽然可以捕捉到网络请求的异常，却无法判断HTTP状态是404还是其他（比如：500等），所以还需要配合服务端日志进行排查分析。</p> <h4 id="window-addeventlistener-unhandledrejection"><a href="#window-addeventlistener-unhandledrejection" class="header-anchor">#</a> window.addEventListener('unhandledRejection')</h4> <p>捕获 <code>Promise</code> 错误，当 <code>Promise</code> 被 <code>reject</code> 且没有 <code>reject</code> 处理器的时候，会触发 <code>unhandledRejection</code> 事件；这可能发生在window下，但也可能发生在Worker中。 这对于调试回退错误处理非常有用。</p> <h3 id="资源加载的错误捕获"><a href="#资源加载的错误捕获" class="header-anchor">#</a> 资源加载的错误捕获</h3> <p>1、<code>imgObj.onerror()</code>
2、<code>performance.getEntries()</code>,获取到成功加载的资源，对比可以间接捕获错误
3、<code>window.addEventListener( 'error', fn,true)</code>, 会捕获但是不冒泡， 所以window.onerror 不会触发，捕获阶段可以出发。</p> <h3 id="vue、react中捕获"><a href="#vue、react中捕获" class="header-anchor">#</a> Vue、React中捕获</h3> <ul><li>Vue有 <code>errorHandler</code> 可以捕获错误</li> <li>React有 <code>componentDidCatch</code> 可以捕获错误</li></ul></details> <h2 id="_02-比较以下表达式1、2、3大小的结果"><a href="#_02-比较以下表达式1、2、3大小的结果" class="header-anchor">#</a> 02 比较以下表达式1、2、3大小的结果</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&gt;</span> <span class="token number">2</span> <span class="token operator">&gt;</span> <span class="token number">3</span><span class="token punctuation">)</span>
 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;</span> <span class="token number">2</span> <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span>
</code></pre></div><details class="custom-block details"><summary>查看答案与解析</summary> <h3 id="答案"><a href="#答案" class="header-anchor">#</a> 答案</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token boolean">true</span> <span class="token boolean">false</span>
</code></pre></div><h3 id="解析"><a href="#解析" class="header-anchor">#</a> 解析</h3> <p>1、运算符 <code>&gt;</code> <code>&lt;</code> 一般是按照从左到右计算。<br>
2、题1: <code>1&lt;2 = true</code> ,然后 <code>true &lt; 3</code>,因为<code>true == 1</code>, 所以结果为 <code>true</code>。<br>
3、题2: <code>3&gt;2 = true</code> ,然后 <code>true &gt; 1</code>,因为<code>true == 1</code>, 所以结果为 <code>false</code>。</p></details> <h2 id="_03-javascript中如何模拟实现方法的重载"><a href="#_03-javascript中如何模拟实现方法的重载" class="header-anchor">#</a> 03 Javascript中如何模拟实现方法的重载</h2> <details class="custom-block details"><summary>查看答案</summary> <h3 id="一、什么是函数重载"><a href="#一、什么是函数重载" class="header-anchor">#</a> 一、什么是函数重载</h3> <p>函数重载是函数的一种特殊情况，为方便使用，允许在同一个范围中声明几个功能类似的同名函数，但是这些同名函数形式参数（个数、类型、或顺序）必须不同，也就是说同一个函数完成不同的功能</p> <h3 id="二、利用闭包特性模拟"><a href="#二、利用闭包特性模拟" class="header-anchor">#</a> 二、利用闭包特性模拟</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">addMethod</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> name<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> old <span class="token operator">=</span> obj<span class="token punctuation">[</span>name<span class="token punctuation">]</span>
  obj<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>fn<span class="token punctuation">.</span>length <span class="token operator">===</span> arguments<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> old <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">old</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">const</span> methods <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token function">addMethod</span><span class="token punctuation">(</span>methods<span class="token punctuation">,</span><span class="token string">'add'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token function">addMethod</span><span class="token punctuation">(</span>methods<span class="token punctuation">,</span><span class="token string">'add'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">a</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> a<span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token function">addMethod</span><span class="token punctuation">(</span>methods<span class="token punctuation">,</span><span class="token string">'add'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span>b</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> a<span class="token operator">+</span>b<span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token function">addMethod</span><span class="token punctuation">(</span>methods<span class="token punctuation">,</span><span class="token string">'add'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> a<span class="token operator">+</span>b<span class="token operator">+</span>c<span class="token punctuation">}</span><span class="token punctuation">)</span>

  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>methods<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 6</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>methods<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 3</span>
<span class="token punctuation">}</span>

</code></pre></div><p>addMethod 接收3个参数；目标对象，目标方法名，函数体，当函数被调用时；<br>
1、先将目标 obj[name] 的值存入old中，起初old的值可能不是一个函数。<br>
2、接着向obj[name] 赋值一个代理函数，并且由于变量old、fn在代理中被调用，所以old、fn将常驻内存不被回收。</p></details> <h2 id="_04-什么是虚拟dom、作用、定义"><a href="#_04-什么是虚拟dom、作用、定义" class="header-anchor">#</a> 04 什么是虚拟DOM、作用、定义？</h2> <details class="custom-block details"><summary>查看答案</summary> <h3 id="什么事虚拟dom"><a href="#什么事虚拟dom" class="header-anchor">#</a> 什么事虚拟DOM</h3> <p>从本质上来说，Virtual DOM 是一个javascript 对象，通过对象的方式来表示DOM结构。将页面的状态抽象为js对象的形式，配合不同的渲染工具，是跨平台渲染成为可能。通过事务处理机制，将多次DOM修改的结果一次性更新到页面上。从而有效的减少页面渲染的次数，减少修改DOM的重绘重排次数，提高渲染性能。</p> <p>虚拟DOM是对DOM的抽象，这个对象是更加轻量级的对DOM的描述。它设计的最初目的，就是更好的跨平台，比如Node.js就没有DOM，如果想实现SSR，那么一个方式就是借助虚拟DOM，因为虚拟DOM本身是js对象。</p> <p>在代码渲染到页面之前。vue或者react会把代码转换成一个虚拟DOM对象，以对象的形式来描述真是DOM结构，最终渲染到页面。在每次数据发生变化之前，虚拟DOM都会缓存一份，在变化之时，现在的虚拟DOM会与缓存的虚拟DOM进行比较。</p> <p>在vue 或者react 内部封装了diff算法，通过这个算法来进行比较，渲染时仅修改 改变的地方。原先没有发生过改变的通过原来的数据进行渲染。</p> <p>另外现代前端框架的一个基本要求就是无需手动操作DOM，一个方面是你为手动操作DOM无法保证程序性能，多人协作的项目中如果review不严格，可能会有开发者写出性能比较低的代码，另一方面更重要的是省略了手动操作DOM可以大大提高工作效率。</p> <h3 id="为什么要用-virtual-dom"><a href="#为什么要用-virtual-dom" class="header-anchor">#</a> 为什么要用 Virtual DOM</h3> <h4 id="_1-保证性能下限-再不进行手动优化的情况下-提供过得去的性能"><a href="#_1-保证性能下限-再不进行手动优化的情况下-提供过得去的性能" class="header-anchor">#</a> 1.保证性能下限，再不进行手动优化的情况下，提供过得去的性能</h4> <ul><li><p>我们来看一下页面渲染的流程：<br> <code>解析HTML</code>  -&gt; <code>生成DOM Tree</code> -&gt; <code>生成CSSOM</code> -&gt; <code>Layout</code> -&gt; <code>Paint</code> -&gt; <code>Compiler</code></p></li> <li><p>对比一下修改DOM时真实DOM操作和Virtual DOM的过程，来看下他们重排重绘的性能消耗：</p> <ul><li>真实DOM：生成HTML字符串 + 重建所有的DOM元素</li> <li>Virtual DOM：生成VNode + DOMDiff + 必要的DOM更新</li></ul></li></ul> <p>Virtual DOM更新DOM的准备工作耗费更多的时间，也就是JS层面，相比于更多的DOM操作他的消费是及其便宜的，尤雨溪在社区论坛中说道：框架给你的保证是，你不需要手动优化的情况下，我依然可以给你提供过得去的性能。</p> <h4 id="_2-跨平台"><a href="#_2-跨平台" class="header-anchor">#</a> 2.跨平台</h4> <p>Virtual DOM本质上是JS的对象，它可以很方便的跨平台操作，比如服务端渲染，uniapp等。</p> <h3 id="virtual-dom真的比真实dom性能好吗"><a href="#virtual-dom真的比真实dom性能好吗" class="header-anchor">#</a> Virtual DOM真的比真实DOM性能好吗？</h3> <ul><li>首次渲染大量DOM时，由于多了一层虚拟DOM的计算，会比innerHTML 插入慢。</li> <li>正如它能保证性能下限，在真实DOM操作的时候进行针对性的优化，还是更快的。</li></ul></details> <h2 id="_05-javascript-垃圾回收方法"><a href="#_05-javascript-垃圾回收方法" class="header-anchor">#</a> 05 javascript 垃圾回收方法</h2> <details class="custom-block details"><summary>查看答案</summary> <ul><li>标记清除（mark and sweep）
<ul><li>这是JavaScript最常见的垃圾回收方式，当变量进入执行环境的时候，比如函数中声明一个变量，垃圾回收器将其标记为“进入环境”，当变量离开环境的时候（函数执行结束）将其标记为“离开环境”</li> <li>垃圾回收器会在运行的时候给存储在内存中的所有变量加上标记，然后去掉环境中的变量以及被环境中变量所引用的变量（闭包），在这些完成之后仍存在标记的就是要删除的变量了</li></ul></li> <li>引用计数（reference counting）
<ul><li>在低版本IE中经常会出现内存泄露，很多时候就是因为其采用引用计数方式进行垃圾回收。引用计数的策略是跟踪记录每个值被使用的次数，当声明了一个 变量并将一个引用类型赋值给该变量的时候这个值的引用次数就加1，如果该变量的值变成了另外一个，则这个值得引用次数减1，当这个值的引用次数变为0的时 候，说明没有变量在使用，这个值没法被访问了，因此可以将其占用的空间回收，这样垃圾回收器会在运行的时候清理掉引用次数为0的值占用的空间</li></ul></li></ul></details></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/tengli1990/vuepress/edit/master/docs/daily/javascript.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">上次更新时间:</span> <span class="time">8/10/2020, 6:40:49 PM</span></div></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/daily/css.html">
        css
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.95d8b7d8.js" defer></script><script src="/assets/js/2.78a10e41.js" defer></script><script src="/assets/js/80.5877c75c.js" defer></script>
  </body>
</html>
