<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>《JavaScript 高级程序设计》 | Power</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/logo.jpg">
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.6aaf0376.css" as="style"><link rel="preload" href="/assets/js/app.95d8b7d8.js" as="script"><link rel="preload" href="/assets/js/2.78a10e41.js" as="script"><link rel="preload" href="/assets/js/75.45a0f288.js" as="script"><link rel="prefetch" href="/assets/js/10.cfa5e85b.js"><link rel="prefetch" href="/assets/js/11.0c71821e.js"><link rel="prefetch" href="/assets/js/12.f9fa359c.js"><link rel="prefetch" href="/assets/js/13.9e3bc96e.js"><link rel="prefetch" href="/assets/js/14.6c22b46e.js"><link rel="prefetch" href="/assets/js/15.b2fd3990.js"><link rel="prefetch" href="/assets/js/16.7b8fc025.js"><link rel="prefetch" href="/assets/js/17.4f2b29dc.js"><link rel="prefetch" href="/assets/js/18.c0b0262b.js"><link rel="prefetch" href="/assets/js/19.05eebd8e.js"><link rel="prefetch" href="/assets/js/20.b42d2fa7.js"><link rel="prefetch" href="/assets/js/21.bbb426e1.js"><link rel="prefetch" href="/assets/js/22.2c360d85.js"><link rel="prefetch" href="/assets/js/23.4e36e967.js"><link rel="prefetch" href="/assets/js/24.dd2a02bc.js"><link rel="prefetch" href="/assets/js/25.4fdc2c70.js"><link rel="prefetch" href="/assets/js/26.765e5c2f.js"><link rel="prefetch" href="/assets/js/27.0d683c07.js"><link rel="prefetch" href="/assets/js/28.5ae1cf56.js"><link rel="prefetch" href="/assets/js/29.87039c54.js"><link rel="prefetch" href="/assets/js/3.a1e70f10.js"><link rel="prefetch" href="/assets/js/30.0be2db26.js"><link rel="prefetch" href="/assets/js/31.34e0b66f.js"><link rel="prefetch" href="/assets/js/32.d2a36d3f.js"><link rel="prefetch" href="/assets/js/33.c165ff05.js"><link rel="prefetch" href="/assets/js/34.8d58d225.js"><link rel="prefetch" href="/assets/js/35.af8ba47e.js"><link rel="prefetch" href="/assets/js/36.c2856159.js"><link rel="prefetch" href="/assets/js/37.3be4e862.js"><link rel="prefetch" href="/assets/js/38.29365dc5.js"><link rel="prefetch" href="/assets/js/39.0f89d5eb.js"><link rel="prefetch" href="/assets/js/4.a3cab100.js"><link rel="prefetch" href="/assets/js/40.b0de374c.js"><link rel="prefetch" href="/assets/js/41.f7f54fec.js"><link rel="prefetch" href="/assets/js/42.e78a1079.js"><link rel="prefetch" href="/assets/js/43.6a46c288.js"><link rel="prefetch" href="/assets/js/44.0ac61bbb.js"><link rel="prefetch" href="/assets/js/45.51b52846.js"><link rel="prefetch" href="/assets/js/46.bd851090.js"><link rel="prefetch" href="/assets/js/47.49eec2aa.js"><link rel="prefetch" href="/assets/js/48.35d13e78.js"><link rel="prefetch" href="/assets/js/49.7a2d3017.js"><link rel="prefetch" href="/assets/js/5.7dce32d1.js"><link rel="prefetch" href="/assets/js/50.a8442fb9.js"><link rel="prefetch" href="/assets/js/51.97aeb1be.js"><link rel="prefetch" href="/assets/js/52.11e0decf.js"><link rel="prefetch" href="/assets/js/53.122dd2bb.js"><link rel="prefetch" href="/assets/js/54.8b2a6d58.js"><link rel="prefetch" href="/assets/js/55.ab9368bd.js"><link rel="prefetch" href="/assets/js/56.6c6370fb.js"><link rel="prefetch" href="/assets/js/57.1559f8fb.js"><link rel="prefetch" href="/assets/js/58.11795bdc.js"><link rel="prefetch" href="/assets/js/59.aeb14e74.js"><link rel="prefetch" href="/assets/js/6.919d1835.js"><link rel="prefetch" href="/assets/js/60.05a91615.js"><link rel="prefetch" href="/assets/js/61.52485bf1.js"><link rel="prefetch" href="/assets/js/62.e6af1bb7.js"><link rel="prefetch" href="/assets/js/63.ff85734d.js"><link rel="prefetch" href="/assets/js/64.46a5c61e.js"><link rel="prefetch" href="/assets/js/65.43f6a76b.js"><link rel="prefetch" href="/assets/js/66.3d62d4b0.js"><link rel="prefetch" href="/assets/js/67.281b831d.js"><link rel="prefetch" href="/assets/js/68.659c11a7.js"><link rel="prefetch" href="/assets/js/69.df8868a2.js"><link rel="prefetch" href="/assets/js/7.c7943989.js"><link rel="prefetch" href="/assets/js/70.0f15d9b1.js"><link rel="prefetch" href="/assets/js/71.35df2385.js"><link rel="prefetch" href="/assets/js/72.0ec7ebc9.js"><link rel="prefetch" href="/assets/js/73.70276bbf.js"><link rel="prefetch" href="/assets/js/74.44fbc6d2.js"><link rel="prefetch" href="/assets/js/76.7086c31b.js"><link rel="prefetch" href="/assets/js/77.c800c400.js"><link rel="prefetch" href="/assets/js/78.c803fa26.js"><link rel="prefetch" href="/assets/js/79.16e33e63.js"><link rel="prefetch" href="/assets/js/8.32e33110.js"><link rel="prefetch" href="/assets/js/80.5877c75c.js"><link rel="prefetch" href="/assets/js/81.9318e369.js"><link rel="prefetch" href="/assets/js/82.838a9e8f.js"><link rel="prefetch" href="/assets/js/83.3e3b07c0.js"><link rel="prefetch" href="/assets/js/84.7bc28721.js"><link rel="prefetch" href="/assets/js/85.6693c059.js"><link rel="prefetch" href="/assets/js/86.8c466531.js"><link rel="prefetch" href="/assets/js/87.8d67a83f.js"><link rel="prefetch" href="/assets/js/88.e58fe875.js"><link rel="prefetch" href="/assets/js/89.3fff6aee.js"><link rel="prefetch" href="/assets/js/9.a57af53f.js">
    <link rel="stylesheet" href="/assets/css/0.styles.6aaf0376.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Power</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">
  博客
</a></div><div class="nav-item"><a href="/basic/" class="nav-link">
  编程基础
</a></div><div class="nav-item"><a href="/daily/" class="nav-link">
  每日一题
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="菜单" class="dropdown-title"><span class="title">更多</span> <span class="arrow down"></span></button> <button type="button" aria-label="菜单" class="mobile-dropdown-title"><span class="title">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          学习相关
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/books/" class="nav-link router-link-active">
  阅读
</a></li><li class="dropdown-subitem"><a href="/tools/" class="nav-link">
  工具
</a></li></ul></li><li class="dropdown-item"><h4>
          实战
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/practice/" class="nav-link">
  BFF
</a></li><li class="dropdown-subitem"><a href="/blog/css-houdini.html#css-画一片星空" class="nav-link">
  CSS Starry Sky
</a></li></ul></li></ul></div></div> <a href="https://github.com/tengli1990/vuepress" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">
  博客
</a></div><div class="nav-item"><a href="/basic/" class="nav-link">
  编程基础
</a></div><div class="nav-item"><a href="/daily/" class="nav-link">
  每日一题
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="菜单" class="dropdown-title"><span class="title">更多</span> <span class="arrow down"></span></button> <button type="button" aria-label="菜单" class="mobile-dropdown-title"><span class="title">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          学习相关
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/books/" class="nav-link router-link-active">
  阅读
</a></li><li class="dropdown-subitem"><a href="/tools/" class="nav-link">
  工具
</a></li></ul></li><li class="dropdown-item"><h4>
          实战
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/practice/" class="nav-link">
  BFF
</a></li><li class="dropdown-subitem"><a href="/blog/css-houdini.html#css-画一片星空" class="nav-link">
  CSS Starry Sky
</a></li></ul></li></ul></div></div> <a href="https://github.com/tengli1990/vuepress" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>技术相关</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/books/javascript-01.html" class="sidebar-link">《你不知道的javascript》上卷</a></li><li><a href="/books/javascript-ap.html" aria-current="page" class="active sidebar-link">《JavaScript 高级程序设计》</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/books/javascript-ap.html#第一章-什么是javascript" class="sidebar-link">第一章 什么是Javascript</a></li><li class="sidebar-sub-header"><a href="/books/javascript-ap.html#第二章-html中的javascript" class="sidebar-link">第二章 HTML中的JavaScript</a></li><li class="sidebar-sub-header"><a href="/books/javascript-ap.html#第三章-语言基础" class="sidebar-link">第三章 语言基础</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="《javascript-高级程序设计》"><a href="#《javascript-高级程序设计》" class="header-anchor">#</a> 《JavaScript 高级程序设计》</h1> <h2 id="第一章-什么是javascript"><a href="#第一章-什么是javascript" class="header-anchor">#</a> 第一章 什么是Javascript</h2> <h3 id="javascript的实现"><a href="#javascript的实现" class="header-anchor">#</a> JavaScript的实现</h3> <p>完整的 JavaScript 实现包含以下几个部分：</p> <ul><li>核心 （ECMAScript）</li> <li>文档对象模型 (DOM)</li> <li>浏览器对象模型 (BOM)</li></ul> <p><img src="/books/JSAP/JSAP-1.2.png" alt="img"></p> <h3 id="ecmascript"><a href="#ecmascript" class="header-anchor">#</a> ECMAScript</h3> <p>ECMAScript，即 ECMA-262 定义的语言，并不局限于 Web 浏览器。事实上，这门语言没有输入和 输出之类的方法。ECMA-262 将这门语言作为一个基准来定义，以便在它之上再构建更稳健的脚本语言。 Web 浏览器只是 ECMAScript 实现可能存在的一种宿主环境(host environment)。宿主环境提供 ECMAScript 的基准实现和与环境自身交互必需的扩展。扩展(比如 DOM)使用 ECMAScript 核心类型 和语法，提供特定于环境的额外功能。其他宿主环境还有服务器端 JavaScript 平台 Node.js 和即将被淘汰 的 Adobe Flash。</p> <p>如果不涉及浏览器的话，ECMA-262 到底定义了什么?在基本的层面，它描述这门语言的如下部分:</p> <ul><li>语法</li> <li>类型</li> <li>语句</li> <li>关键字</li> <li>保留字</li> <li>操作符</li> <li>全局对象</li></ul> <p>ECMAScript 只是对实现这个规范描述的所有方面的一门语言的称呼。JavaScript 实现了ECMAScript，而 Adobe ActionScript 同样也实现了 ECMAScript。</p> <h4 id="版本"><a href="#版本" class="header-anchor">#</a> 版本</h4> <blockquote><p>从ES5版本开始看起</p></blockquote> <ul><li>ECMAScript 3.1 (ECMA-262 第 5 版)
于 2009 年 12 月 3 日正式发布。第 5 版致力于厘清 11 第 3 版存在的歧义，也增加了新功能。<br> <strong>新功能包括：JSON 对象 、 方便继承和高级属性定义的方法，以及严格模式</strong>。<br>
第5版在2011年6月发布了一个维护性修订版，这个修订版只更正了规范中的错误，并未增加任何新的语言 或库特性。</li> <li>ES6、ES2015 或 ES Harmony(和谐版) (ECMA-262 第 6 版)
2015 年 6 月发布。这一版包 含了大概这个规范有史以来最重要的一批增强特性。<br> <strong>ES6 正式支持了类、模块、迭代器、生成器、箭头 函数、期约、反射、代理和众多新的数据类型</strong>。</li> <li>ES7 或 ES2016 ECMA-262 第 7 版
于 2016 年 6 月发布。这次修订只包含少量语法层面的 增强，如 Array.prototype.includes 和指数操作符。</li> <li>ES8 或 ES2017 ECMA-262 第 8 版
完成于 2017 年 6 月。这一版主要增加了异步函数(async/ await)、SharedArrayBuffer 及 Atomics API，以及 Object.values()/Object.entries()/Object. getOwnPropertyDescriptors()和字符串填充方法，另外明确支持对象字面量最后的逗号。</li> <li>ES9 或 ES2018 ECMA-262 第 9 版
发布于 2018 年 6 月。这次修订包括异步迭代、剩余和 扩展属性、一组新的正则表达式特性、Promise finally()，以及模板字面量修订。</li> <li>ES10 或 ES2019 ECMA-262 第 10 版
发布于 2019 年 6 月。这次修订增加了 Array.prototype. flat()/flatMap()、String.prototype.trimStart()/trimEnd()、Object.fromEntries()方 法，以及 Symbol.prototype.description 属性，明确定义了 Function.prototype.toString() 的返回值并固定了 Array.prototype.sort()的顺序。另外，这次修订解决了与 JSON 字符串兼容的 问题，并定义了 catch 子句的可选绑定。</li></ul> <h4 id="符合性"><a href="#符合性" class="header-anchor">#</a> 符合性</h4> <blockquote><p>ECMA-262 阐述了什么是 ECMAScript 符合性。要成为 ECMAScript 实现，必须满足下列条件:</p></blockquote> <p> 支持 ECMA-262 中描述的所有“类型、值、对象、属性、函数，以及程序语法与语义”;<br>
 支持 Unicode 字符标准。</p> <p>此外，符合性实现还可以满足下列要求。</p> <p> 增加 ECMA-262 中未提及的“额外的类型、值、对象、属性和函数”。ECMA-262 所说的这些额外内容主要指规范中未给出的新对象或对象的新属性。<br>
 支持 ECMA-262 中没有定义的“程序和正则表达式语法”(意思是允许修改和扩展内置的正则表达式特性)。<br>
以上条件为实现开发者基于 ECMAScript 开发语言提供了极大的权限和灵活度，也是其广受欢迎的原因之一。</p> <h2 id="第二章-html中的javascript"><a href="#第二章-html中的javascript" class="header-anchor">#</a> 第二章 HTML中的JavaScript</h2> <div id="2.1 script元素" class="m-title" data-v-6414a9a2><a href="#2.1 script元素" class="header-anchor" data-v-6414a9a2>#</a><span data-v-6414a9a2>2.1 script元素</span></div> <p>将 JavaScript 插入 HTML 的主要方法是使用<code>&lt;script&gt;</code>元素。这个元素是由网景公司创造出来，并 最早在 Netscape Navigator 2 中实现的。后来，这个元素被正式加入到 HTML 规范。<code>&lt;script&gt;</code>元素有下 列 8 个属性。</p> <div id="属性crossorigin" class="m-title is-sub" data-v-6414a9a2><a href="#属性crossorigin" class="header-anchor" data-v-6414a9a2>#</a><span data-v-6414a9a2>属性crossorigin</span></div> <p>可选属性<br>
配置相关请求的 CORS(跨源资源共享)设置。默认不使用 CORS。crossorigin= &quot;anonymous&quot;配置文件请求不必设置凭据标志。crossorigin=&quot;use-credentials&quot;设置凭据 标志，意味着出站请求会包含凭据。</p> <h4 id="基本概念"><a href="#基本概念" class="header-anchor">#</a> 基本概念</h4> <ul><li>Cross Origin Resource Share
简称 CORS，译为<strong>跨源资源共享</strong>，所涉及到的HTML标签元素有：script、link、img、audio、video</li> <li>Origin的组成
由protocol、domain、port三部分组成</li></ul> <h4 id="凭据模式"><a href="#凭据模式" class="header-anchor">#</a> 凭据模式</h4> <ul><li>anonymous 不包含凭据，即匿名</li> <li>use-credentals 包含凭据</li></ul> <div class="custom-block tip"><p class="custom-block-title">凭据是什么？</p> <p>指的就是Cookie，匿名就是不需要携带cookie发送请求。默认值是anonymous。</p></div> <div id="属性integrity" class="m-title is-sub" data-v-6414a9a2><a href="#属性integrity" class="header-anchor" data-v-6414a9a2>#</a><span data-v-6414a9a2>属性integrity</span></div> <p>允许比对接收到的资源和指定的加密签名以验证子资源完整性(SRI，Subresource Integrity)。<br>
如果接收到的资源的签名与这个属性指定的签名不匹配，则页面会报错，脚本不会执行。这个属性可以用于确保内容分发网络(CDN，Content Delivery Network)不会提供恶意内容。</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">crossorigin</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>anonymous<span class="token punctuation">&quot;</span></span> <span class="token attr-name">integrity</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sha384-AQSFWSDFSDF...<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://lib.baomutu.com/jquery.min.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>浏览器在加载带有integrity属性的script或link标签时，在下载文件后，会先比较自己计算的散列值与integrity属性的值，如果不等则返回网络错误</p> <div id="属性src" class="m-title is-sub" data-v-6414a9a2><a href="#属性src" class="header-anchor" data-v-6414a9a2>#</a><span data-v-6414a9a2>属性src</span></div> <p>可选属性。表示包含要执行的代码的外部文件。</p> <div id="属性async 和 defer" class="m-title is-sub" data-v-6414a9a2><a href="#属性async 和 defer" class="header-anchor" data-v-6414a9a2>#</a><span data-v-6414a9a2>属性async 和 defer</span></div> <p>我们来分析下面这张图：
<img src="/books/JSAP/JSAP-1.3.png" alt="img"></p> <ul><li><p><code>&lt;script&gt;</code><br>
加载页面parser过程中遇到此类标签,浏览器会停止解析去请求script的资源并执行，执行后继续解析。</p></li> <li><p><code>&lt;script defer&gt;</code><br>
异步加载script资源，不会影响解析，但是需要等到解析完成之后执行脚本。执行完脚本之后 触发 DOMContentLoaded 事件</p></li> <li><p><code>&lt;script async&gt;</code><br>
与defer相似，都是异步加载，区别是在加载完成之后立即执行，会中断解析，执行完成之后继续解析。</p></li> <li><p><code>&lt;script type=&quot;module&quot;&gt;</code><br>
ES module的加载方式默认是应用了defer的方式加载，上图fetch的部分的分叉是因为会并行的加载其他依赖的js文件。等依赖全部加载完成后不会立即执行，需要等到文档解析完成后，执行DOMCOntentLoaded前一步 执行js</p></li> <li><p><code>&lt;script type=&quot;module&quot; async&gt;</code><br>
ES module的async方式加载，是在加载全部依赖的js完成之后立即执行，会中断解析，执行完成之后继续解析。</p></li></ul> <div class="custom-block warning"><p class="custom-block-title">defer</p> <p>表示应该立即开始下载脚本，但不能阻塞页面其他动作，比如下载资源或等待其 他脚本加载。只对外部脚本文件有效。</p></div> <div class="custom-block warning"><p class="custom-block-title">async</p> <p>表示脚本可以延迟到文档完全被解析和显示之后再执行。只对外部脚本文件有效。 在 IE7 及更早的版本中，对行内脚本也可以指定这个属性。</p></div> <div id="2.2 行内代码与外部文件" class="m-title" data-v-6414a9a2><a href="#2.2 行内代码与外部文件" class="header-anchor" data-v-6414a9a2>#</a><span data-v-6414a9a2>2.2 行内代码与外部文件</span></div> <p>虽然可以直接在 HTML 文件中嵌入 JavaScript 代码，但通常认为最佳实践是尽可能将 JavaScript 代 码放在外部文件中。不过这个最佳实践并不是明确的强制性规则。推荐使用外部文件的理由如下。</p> <p> <strong>可维护性</strong><br>
JavaScript 代码如果分散到很多 HTML 页面，会导致维护困难。而用一个目录保存 所有 JavaScript 文件，则更容易维护，这样开发者就可以独立于使用它们的 HTML 页面来编辑 代码。</p> <p> <strong>缓存</strong><br>
浏览器会根据特定的设置缓存所有外部链接的 JavaScript 文件，这意味着如果两个页面都 用到同一个文件，则该文件只需下载一次。这最终意味着页面加载更快。</p> <p> <strong>适应未来</strong><br>
通过把 JavaScript 放到外部文件中，就不必考虑用 XHTML 或前面提到的注释黑科技。 包含外部 JavaScript 文件的语法在 HTML 和 XHTML 中是一样的。</p> <p>在配置浏览器请求外部文件时，要重点考虑的一点是它们会占用多少带宽。在 SPDY/HTTP2 中， 预请求的消耗已显著降低，以轻量、独立 JavaScript 组件形式向客户端送达脚本更具优势。</p> <p>比如，第一个页面包含如下脚本:</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mainA.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>component1.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>component2.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>component3.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
...
</code></pre></div><p>后续页面可能包含如下脚本:</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mainB.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>component3.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>component4.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>component5.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
...
</code></pre></div><p>在初次请求时，如果浏览器支持 SPDY/HTTP2，就可以从同一个地方取得一批文件，并将它们逐个 放到浏览器缓存中。从浏览器角度看，通过 SPDY/HTTP2 获取所有这些独立的资源与获取一个大 JavaScript 文件的延迟差不多。</p> <p>在第二个页面请求时，由于你已经把应用程序切割成了轻量可缓存的文件，第二个页面也依赖的某 些组件此时已经存在于浏览器缓存中了。</p> <p>当然，这里假设浏览器支持 SPDY/HTTP2，只有比较新的浏览器才满足。如果你还想支持那些比较 老的浏览器，可能还是用一个大文件更合适。</p> <div id="2.3 文档模式" class="m-title" data-v-6414a9a2><a href="#2.3 文档模式" class="header-anchor" data-v-6414a9a2>#</a><span data-v-6414a9a2>2.3 文档模式</span></div> <ul><li>混杂模式(quirks mode)：前者让 IE 像 IE5 一样(支持一些非标准的特性)</li> <li>标准模式(standards mode)：让 IE 具有兼容标准的行为。</li></ul> <p>以上两种模式的主要区别只体现在通过 <code>CSS</code> 渲染的内容方面，但对 <code>JavaScript</code> 也有一些关联影响，或称为副作用。</p> <ul><li>准标准模式<br>
这种模式下的浏览器支持很多标准的特性，但是没有标准规定得那么严格。主要区别在于如何对待图片元素周围的空白(在表格中使用图片时最明显)。</li></ul> <div id="模式的声明" class="m-title is-sub" data-v-6414a9a2><a href="#模式的声明" class="header-anchor" data-v-6414a9a2>#</a><span data-v-6414a9a2>模式的声明</span></div> <h4 id="混杂模式"><a href="#混杂模式" class="header-anchor">#</a> 混杂模式</h4> <p>混杂模式在所有浏览器中都以省略文档开头的 doctype 声明作为开关。</p> <h4 id="标准模式通过下列几种文档类型声明开启"><a href="#标准模式通过下列几种文档类型声明开启" class="header-anchor">#</a> 标准模式通过下列几种文档类型声明开启:</h4> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- HTML 4.01 Strict --&gt;</span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">HTML</span> <span class="token name">PUBLIC</span> <span class="token string">&quot;-//W3C//DTD HTML 4.01//EN&quot;</span> <span class="token string">&quot;http://www.w3.org/TR/html4/strict.dtd&quot;</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- XHTML 1.0 Strict --&gt;</span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span> <span class="token name">PUBLIC</span> <span class="token string">&quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot;</span> <span class="token string">&quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;</span><span class="token punctuation">&gt;</span></span> 

<span class="token comment">&lt;!-- HTML5 --&gt;</span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h4 id="准标准模式通过过渡性文档类型-transitional-和框架集文档类型-frameset-来触发"><a href="#准标准模式通过过渡性文档类型-transitional-和框架集文档类型-frameset-来触发" class="header-anchor">#</a> 准标准模式通过过渡性文档类型(Transitional)和框架集文档类型(Frameset)来触发:</h4> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- HTML 4.01 Transitional --&gt;</span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">HTML</span> <span class="token name">PUBLIC</span> <span class="token name">5</span> <span class="token string">&quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;</span> <span class="token string">&quot;http://www.w3.org/TR/html4/loose.dtd&quot;</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- HTML 4.01 Frameset --&gt;</span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">HTML</span> <span class="token name">PUBLIC</span> <span class="token string">&quot;-//W3C//DTD HTML 4.01 Frameset//EN&quot;</span> <span class="token string">&quot;http://www.w3.org/TR/html4/frameset.dtd&quot;</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- XHTML 1.0 Transitional --&gt;</span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span> <span class="token name">PUBLIC</span> <span class="token string">&quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;</span> <span class="token string">&quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- XHTML 1.0 Frameset --&gt;</span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span> <span class="token name">PUBLIC</span> <span class="token string">&quot;-//W3C//DTD XHTML 1.0 Frameset//EN&quot;</span> <span class="token string">&quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd&quot;</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>准标准模式与标准模式非常接近，很少需要区分。后续所提到的<strong>标准模式</strong>，指的就是除混杂模式以外的模式。</p> <div id="2.4 &lt;noscript&gt; 元素" class="m-title" data-v-6414a9a2><a href="#2.4 &lt;noscript&gt; 元素" class="header-anchor" data-v-6414a9a2>#</a><span data-v-6414a9a2>2.4 &lt;noscript&gt; 元素</span></div> <p>在下列两种 情况下，浏览器将显示包含在<code>&lt;noscript&gt;</code>中的内容:</p> <p> 浏览器不支持脚本;<br>
 浏览器对脚本的支持被关闭。</p> <p>任何一个条件被满足，包含在<code>&lt;noscript&gt;</code>中的内容就会被渲染。否则，浏览器不会渲染<code>&lt;noscript&gt;</code>中的内容。</p> <div id="小结" class="m-title" data-v-6414a9a2><a href="#小结" class="header-anchor" data-v-6414a9a2>#</a><span data-v-6414a9a2>小结</span></div> <p>JavaScript 是通过<code>&lt;script&gt;</code>元素插入到 HTML 页面中的。这个元素可用于把 JavaScript 代码嵌入到 HTML 页面中，跟其他标记混合在一起，也可用于引入保存在外部文件中的 JavaScript。</p> <p> 要包含外部 JavaScript 文件，必须将 src 属性设置为要包含文件的 URL。文件可以跟网页在同 一台服务器上，也可以位于完全不同的域。</p> <p> 所有<code>&lt;script&gt;</code>元素会依照它们在网页中出现的次序被解释。在不使用 defer 和 async 属性的 情况下，包含在<code>&lt;script&gt;</code>元素中的代码必须严格按次序解释。</p> <p> 对不推迟执行的脚本，浏览器必须解释完位于<code>&lt;script&gt;</code>元素中的代码，然后才能继续渲染页面 的剩余部分。为此，通常应该把<code>&lt;script&gt;</code>元素放到页面末尾，介于主内容之后及<code>&lt;/body&gt;</code>标签 之前。</p> <p> 可以使用 defer 属性把脚本推迟到文档渲染完毕后再执行。推迟的脚本原则上按照它们被列出 的次序执行。</p> <p> 可以使用 async 属性表示脚本不需要等待其他脚本，同时也不阻塞文档渲染，即异步加载。异 步脚本不能保证按照它们在页面中出现的次序执行。</p> <p> 通过使用<code>&lt;noscript&gt;</code>元素，可以指定在浏览器不支持脚本时显示的内容。如果浏览器支持并启 用脚本，则<code>&lt;noscript&gt;</code>元素中的任何内容都不会被渲染。</p> <h2 id="第三章-语言基础"><a href="#第三章-语言基础" class="header-anchor">#</a> 第三章 语言基础</h2> <p>ES5 定义的ECMAScript是目前位置实现最为广泛（受浏览器支持最好的）的一个版本。<br>
ES6 受浏览器支持的程度次之，到 2017 年底，大多数主流浏览 器几乎或全部实现了这一版的规范。</p> <div id="3.1 语法" class="m-title" data-v-6414a9a2><a href="#3.1 语法" class="header-anchor" data-v-6414a9a2>#</a><span data-v-6414a9a2>3.1 语法</span></div> <p>ECMAScript 的语法很大程度上借鉴了 C 语言和其他类 C 语言，如 Java 和 Perl。熟悉这些语言的开发者，应该很容易理解 ECMAScript 宽松的语法。</p> <div id="3.1.1 区分大小写" class="m-title is-sub" data-v-6414a9a2><a href="#3.1.1 区分大小写" class="header-anchor" data-v-6414a9a2>#</a><span data-v-6414a9a2>3.1.1 区分大小写</span></div> <p>ECMAScript 中一切都区分大小写。无论是变量、函数名还是操作符，都区分大 10 小写。</p> <div id="3.1.2 标识符" class="m-title is-sub" data-v-6414a9a2><a href="#3.1.2 标识符" class="header-anchor" data-v-6414a9a2>#</a><span data-v-6414a9a2>3.1.2 标识符</span></div> <p>所谓标识符，就是变量、函数、属性或函数参数的名称。</p> <h4 id="标识符的组成"><a href="#标识符的组成" class="header-anchor">#</a> 标识符的组成</h4> <p> 第一个字符必须是一个字母、下划线(_)或美元符号($);<br>
 剩下的其他字符可以是字母、下划线、美元符号或数字。</p> <div class="custom-block warning"><p class="custom-block-title">标识符格式</p> <p>尽量使用驼峰大小写形式，即第一个单词的首字母小写，后面每个单词的首字母大写，如:firstSecond、myCar、doSomethingImportant</p></div> <div class="custom-block danger"><p class="custom-block-title">注意</p> <p>关键字、保留字、true、false和null不能作为标识符。</p></div> <div id="3.1.3 注释" class="m-title is-sub" data-v-6414a9a2><a href="#3.1.3 注释" class="header-anchor" data-v-6414a9a2>#</a><span data-v-6414a9a2>3.1.3 注释</span></div> <p>// 单行注释<br>
/* 这是多行 注释 */</p> <div id="3.1.4 严格模式" class="m-title is-sub" data-v-6414a9a2><a href="#3.1.4 严格模式" class="header-anchor" data-v-6414a9a2>#</a><span data-v-6414a9a2>3.1.4 严格模式</span></div> <p>ES5 新增严格模式（strict mode）的概念。 它是一种不同的 JavaScript 解析和执 行模型，ES3中一些不规范的写法或不安全的活动会被抛出错误。</p> <h4 id="使用"><a href="#使用" class="header-anchor">#</a> 使用</h4> <p>文件中使用：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">'use strict'</span>
</code></pre></div><p>函数体中使用：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">todo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token string">'use strict'</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">支持</p> <p>所有现代浏览器 都支持严格模式。</p></div> <div id="3.1.5 语句" class="m-title is-sub" data-v-6414a9a2><a href="#3.1.5 语句" class="header-anchor" data-v-6414a9a2>#</a><span data-v-6414a9a2>3.1.5 语句</span></div> <h4 id="分号"><a href="#分号" class="header-anchor">#</a> 分号</h4> <p>语句以分号结尾。省略分号意味着由解析器确定语句在哪里结尾。
加分号可以：</p> <ul><li>避免输入内容不完整</li> <li>避免导致语法错误</li> <li>有助于在某些情况下提升性能</li></ul> <h4 id="代码块"><a href="#代码块" class="header-anchor">#</a> 代码块</h4> <p>if 控制语句执行单条语句时也应该尽量添加代码块，避免导致错误</p> <div class="custom-block warning"><p class="custom-block-title">使用代码块</p> <p>可以让内容更清晰，修改代码时也可以减少出错的可能性</p></div> <div id="3.2 关键字与保留字" class="m-title" data-v-6414a9a2><a href="#3.2 关键字与保留字" class="header-anchor" data-v-6414a9a2>#</a><span data-v-6414a9a2>3.2 关键字与保留字</span></div> <p>保留的关键字不能用作标识符或属性名。</p> <p>ES6规定的所有关键字如下:</p> <p><code>break</code> <code>do</code> <code>in</code> <code>typeof</code> <code>case</code> <code>else</code> <code>instanceof</code> <code>var</code> <code>catch</code> <code>export</code> <code>new</code> <code>void</code> <code>class</code> <code>extends</code> <code>return</code> <code>while</code> <code>const</code> <code>finally</code> <code>super</code> <code>with</code> <code>continue</code> <code>for</code> <code>switch</code> <code>yield</code> <code>debugger</code> <code>function</code> <code>this</code> <code>default</code> <code>if</code> <code>throw</code> <code>delete</code> <code>import</code> <code>try</code></p> <p>保留字：<br> <code>enum</code></p> <p>严格模式保留字：</p> <p><code>implements</code> <code>package</code> <code>public</code> <code>interface</code> <code>protected</code> <code>static</code> <code>let</code> <code>private</code></p> <p>模块代码中保留:</p> <p><code>await</code></p> <div class="custom-block warning"><p class="custom-block-title">注意</p> <p>以上词汇不能用做标识符，但可以用作对象的属性名。（最好还是不要使用关键字和保留字作为属性名）</p></div> <div id="3.3 变量" class="m-title" data-v-6414a9a2><a href="#3.3 变量" class="header-anchor" data-v-6414a9a2>#</a><span data-v-6414a9a2>3.3 变量</span></div> <div id="var" class="m-title is-sub" data-v-6414a9a2><a href="#var" class="header-anchor" data-v-6414a9a2>#</a><span data-v-6414a9a2>var</span></div> <ul><li>函数级作用域</li> <li>作用域提升</li> <li>重复声明不报错</li> <li>全局声明的变量成为window对象的属性</li></ul> <div class="custom-block warning"><p class="custom-block-title">注意</p> <p>不推荐通过省略var操作符来定义全局变量，因为这很难维护，也会造成困扰。在严格模式下，给未声明的变量赋值，则会抛出ReferanceError。</p></div> <div id="let" class="m-title is-sub" data-v-6414a9a2><a href="#let" class="header-anchor" data-v-6414a9a2>#</a><span data-v-6414a9a2>let</span></div> <ul><li>块级作用于</li> <li>没有提升，有TDZ（Temporal Dead Zone）</li> <li>不能重复生命</li> <li>混用var和let，重复声明会报错</li> <li>全局声明不是window对象的属性</li></ul> <div id="const" class="m-title is-sub" data-v-6414a9a2><a href="#const" class="header-anchor" data-v-6414a9a2>#</a><span data-v-6414a9a2>const</span></div> <ul><li>声明同时必须初始化变量</li> <li>初始化后不能修改</li> <li>不能修改仅限于常量的引用</li> <li>不能用于声明会自增的迭代变量</li></ul> <div id="声明风格及最佳实践" class="m-title is-sub" data-v-6414a9a2><a href="#声明风格及最佳实践" class="header-anchor" data-v-6414a9a2>#</a><span data-v-6414a9a2>声明风格及最佳实践</span></div> <ul><li>不使用var</li> <li>优先使用const，次之let</li></ul> <div id="3.4 数据类型" class="m-title" data-v-6414a9a2><a href="#3.4 数据类型" class="header-anchor" data-v-6414a9a2>#</a><span data-v-6414a9a2>3.4 数据类型</span></div> <div id="typeof操作符" class="m-title is-sub" data-v-6414a9a2><a href="#typeof操作符" class="header-anchor" data-v-6414a9a2>#</a><span data-v-6414a9a2>typeof操作符</span></div> <p>对一个值使用 typeof 操作符会返回下列字符串之一:</p> <table><thead><tr><th>值</th> <th>含义</th> <th>值</th> <th>含义</th></tr></thead> <tbody><tr><td>'undefined'</td> <td>表示值为定义</td> <td>'function'</td> <td>表示值为函数</td></tr> <tr><td>'string'</td> <td>表示值为字符串</td> <td>'boolean'</td> <td>表示值为布尔值</td></tr> <tr><td>'number'</td> <td>表示值为数字</td> <td>'object'</td> <td>表示值为对象</td></tr> <tr><td>'symbol'</td> <td>表示值为符号</td> <td></td> <td></td></tr></tbody></table> <div class="custom-block warning"><p class="custom-block-title">注意</p> <ul><li>调用 typeof null 返回的是&quot;object&quot;。这是因为特殊值 null 被认为是一个对空对象的引用。</li> <li>严格来讲，函数在ECMAScript中被认为是对象，并不代表一种数据类型。可是， 函数也有自己特殊的属性。为此，就有必要通过 typeof 操作符来区分函数和其他对象。</li></ul></div> <div id="Undefined类型" class="m-title is-sub" data-v-6414a9a2><a href="#Undefined类型" class="header-anchor" data-v-6414a9a2>#</a><span data-v-6414a9a2>Undefined类型</span></div> <p>Undefined 类型只有一个值，就是特殊值undefined，当使用var或let声明一个变量但未初始化时，这个变量的值就等于undefined</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> message 
message <span class="token operator">==</span> <span class="token keyword">undefined</span> <span class="token comment">// true</span>
</code></pre></div><p>包含 undefined 值的变量跟未定义变量是有区别的。请看下面的例子:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> message 
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span> <span class="token comment">// undefined</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span> <span class="token comment">// 报错：age is not defined</span>
<span class="token keyword">typeof</span> age  <span class="token comment">// undefined typeof的特殊的安全防范机制避免了报错</span>
</code></pre></div><div id="Null类型" class="m-title is-sub" data-v-6414a9a2><a href="#Null类型" class="header-anchor" data-v-6414a9a2>#</a><span data-v-6414a9a2>Null类型</span></div> <p>特殊值null，即空对象指针，这也是typeof null === 'object'的原因。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>a<span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> a <span class="token operator">===</span> <span class="token string">'object'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">// 如果成立 则a为null</span>
<span class="token punctuation">}</span>
</code></pre></div><div id="Boolean" class="m-title is-sub" data-v-6414a9a2><a href="#Boolean" class="header-anchor" data-v-6414a9a2>#</a><span data-v-6414a9a2>Boolean</span></div> <p>Boolean(布尔值)类型是 ECMAScript 中使用最频繁的类型之一，有两个字面值:true 和 false。 这两个布尔值不同于数值，因此 true 不等于 1，false 不等于 0。</p> <div class="custom-block warning"><p class="custom-block-title">⚠️ 注意</p> <p>布尔值字面量 true 和 false 是区分大小写的，因此 True 和 False(及其他大小混写形式) 5 是有效的标识符，但不是布尔值。</p></div> <div id="3.4.7 Symbol类型" class="m-title is-sub" data-v-6414a9a2><a href="#3.4.7 Symbol类型" class="header-anchor" data-v-6414a9a2>#</a><span data-v-6414a9a2>3.4.7 Symbol类型</span></div> <p>Symbol 是 ES6新增的数据类型，符号是原始值，且符号实例唯一、不可变。</p> <ul><li><ol><li>符号的基本用法</li></ol></li> <li><ol start="2"><li>使用全局符号注册表</li></ol></li> <li><ol start="3"><li>使用符号作为属性</li></ol></li> <li><ol start="4"><li>常用内置符号</li></ol></li> <li><ol start="5"><li>Symbol.asyncIterator</li></ol></li> <li><ol start="6"><li>Symbol.hasInstance</li></ol></li> <li><ol start="7"><li>Symbol.isConcatSpreadable</li></ol></li> <li><ol start="8"><li>Symbol.iterator</li></ol></li> <li><ol start="9"><li>Symbol.match</li></ol></li> <li><ol start="10"><li>Symbol.replace</li></ol></li> <li><ol start="11"><li>Symbol.search</li></ol></li> <li><ol start="12"><li>Symbol.species</li></ol></li> <li><ol start="13"><li>Symbol.split</li></ol></li> <li><ol start="14"><li>Symbol.toPrimitive</li></ol></li> <li><ol start="15"><li>Symbol.toStringTag</li></ol></li> <li><ol start="16"><li>Symbol.unscopables</li></ol></li></ul> <h4 id="_1-符号的基本用法"><a href="#_1-符号的基本用法" class="header-anchor">#</a> 1.符号的基本用法</h4> <h5 id="使用函数symbol-初始化"><a href="#使用函数symbol-初始化" class="header-anchor">#</a> 使用函数Symbol()初始化</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> sym <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> sym <span class="token punctuation">)</span> <span class="token comment">// symbol</span>
</code></pre></div><h5 id="使用字符串描述symbol"><a href="#使用字符串描述symbol" class="header-anchor">#</a> 使用字符串描述Symbol()</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> fooSymbol <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> otherFooSymbol <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>genericSymbol <span class="token operator">==</span> otherGenericSymbol<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// false</span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">⚠️ 注意</p> <p>以上代码传入的 “foo”描述字符串参数 与 符号定义或标识完全无关</p></div> <h5 id="symbol-函数不能创建包装对象"><a href="#symbol-函数不能创建包装对象" class="header-anchor">#</a> Symbol()函数不能创建包装对象</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> mySymbol <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// TypeError: Symbol is not a constructor</span>
</code></pre></div><p>可以借用 Object()函数实现包装对象</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> objSym <span class="token operator">=</span> <span class="token function">Object</span><span class="token punctuation">(</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> objSym<span class="token punctuation">)</span> <span class="token comment">// object</span>
</code></pre></div><h4 id="_2-使用全局符号注册表"><a href="#_2-使用全局符号注册表" class="header-anchor">#</a> 2.使用全局符号注册表</h4> <h5 id="可以通过使用symbol-for方法创建并重用符号"><a href="#可以通过使用symbol-for方法创建并重用符号" class="header-anchor">#</a> 可以通过使用Symbol.for方法创建并重用符号</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 第一次执行创建符号</span>
<span class="token keyword">let</span> fooSym <span class="token operator">=</span> Symbol<span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">&quot;foo&quot;</span><span class="token punctuation">)</span> 
<span class="token comment">// 第二次查找是否已经创建了 foo 符号 如果创建了 则直接返回已创建的符号</span>
<span class="token keyword">let</span> otherSym <span class="token operator">=</span> Symbol<span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">&quot;foo&quot;</span><span class="token punctuation">)</span> 
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fooSym <span class="token operator">===</span> otherSym<span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">⚠️ 注意</p> <ul><li>通过Symbol('foo') 直接创建的符号不能被Symbol.for('foo')查找到，所以他们并不相等。</li> <li>任何传给Symbol.for方法的参数都会被转换为字符串，此外，注册表中使用的键同时也会被用作符号描述。</li></ul></div> <h5 id="使用symbol-keyfor-查询注册表"><a href="#使用symbol-keyfor-查询注册表" class="header-anchor">#</a> 使用Symbol.keyFor()查询注册表</h5> <p>Symbol.keyFor()这个方法接收符号作为参数，返回全局对应的字符串键。如果找不到则返回<code>undefined</code>。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> sym <span class="token operator">=</span> Symbol<span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Symbol<span class="token punctuation">.</span><span class="token function">keyFor</span><span class="token punctuation">(</span>sym<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// foo</span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">⚠️ 注意</p> <p>Symbol.keyFor()如果接收的不是符号，那么就会抛出错误：TypeError: xxx is not a symbol</p></div> <h4 id="_3-使用符号作为属性"><a href="#_3-使用符号作为属性" class="header-anchor">#</a> 3.使用符号作为属性</h4> <p>凡是可以使用字符串或数值作为属性的地方，都可以使用符号。这就包括了对象字面量属性和 Object.defineProperty()/Object.defineProperties()定义的属性。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> s1 <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> s2 <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'bar'</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> s3 <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'baz'</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> s4 <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'qux'</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> o <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>s1<span class="token punctuation">]</span><span class="token operator">:</span><span class="token string">'my name is s1'</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>s2<span class="token punctuation">]</span><span class="token operator">:</span><span class="token string">'my name is s2'</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>s3<span class="token punctuation">]</span><span class="token operator">:</span><span class="token string">'my name is s3'</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>s4<span class="token punctuation">]</span><span class="token operator">:</span><span class="token string">'my name is s4'</span>
<span class="token punctuation">}</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>o<span class="token punctuation">,</span>s2<span class="token punctuation">,</span><span class="token punctuation">{</span>
  <span class="token literal-property property">value</span><span class="token operator">:</span><span class="token string">'my real name is bar'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperties</span><span class="token punctuation">(</span>o<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>s3<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">'baz'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>s4<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">'qux'</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>o<span class="token punctuation">[</span>s1<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// my name is s1</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>o<span class="token punctuation">[</span>s2<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// my real name is bar</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>o<span class="token punctuation">[</span>s3<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// baz</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>o<span class="token punctuation">[</span>s4<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// qux</span>
</code></pre></div><h5 id="object-getownpropertynames-object-getownpropertysymbols"><a href="#object-getownpropertynames-object-getownpropertysymbols" class="header-anchor">#</a> Object.getOwnPropertyNames &amp; Object.getOwnPropertySymbols</h5> <p>首先我们来看 getOwnPropertyNames 的用法，用来获取对象属性的集合，但是不包括Symbol的符号属性</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">bar</span><span class="token operator">:</span><span class="token string">'bar'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">foo</span><span class="token operator">:</span><span class="token string">'foo'</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'baz'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">:</span><span class="token string">'symbol'</span>
<span class="token punctuation">}</span>
Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyNames</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token comment">// ['bar','foo']</span>
</code></pre></div><p>获取符号的属性需要使用 getOwnPropertySymbols 方法</p> <div class="language-js extra-class"><pre class="language-js"><code>Object<span class="token punctuation">.</span><span class="token function">getOwnPropertySymbols</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token comment">// [Symbol(baz)]</span>
</code></pre></div><h4 id="_4-常用内置符号"><a href="#_4-常用内置符号" class="header-anchor">#</a> 4.常用内置符号</h4> <p>ES6 引入了一批常用的内置符号，用于暴露语言内部的行为；</p> <h5 id="特点"><a href="#特点" class="header-anchor">#</a> 特点</h5> <ul><li>以Symbol工厂函数字符串属性的形式存在。</li> <li>可直接访问、重写或模拟</li> <li>最重要的用途就是用来重新定义，从而改变原生结构,例如：修改for of 中的Symbol.iterator</li> <li>所有内置符号都是不可写、不可枚举、不可配置</li></ul> <div class="custom-block warning"><p class="custom-block-title">⚠️ 注意</p> <p>在ECMAScript规范中，提到的@@iterator 指的就是 Symbol.iterator</p></div> <h4 id="_5-symbol-asynciterator"><a href="#_5-symbol-asynciterator" class="header-anchor">#</a> 5.Symbol.asyncIterator</h4> <ul><li>是一个方法</li> <li>该方法返回对象默认的AsyncIterator。</li> <li>使用for-await-of语句遍历执行异步迭代操作。循环时，它们会调用以 Symbol.asyncIterator 为键的函数，并期望这个函数会返回一个实现迭代器 API 的对象。很多时候，返回的对象是实现该 API 的 AsyncGenerator:<div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Emitter</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">max</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>max <span class="token operator">=</span> max<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>asyncIdx <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token punctuation">}</span>

  async <span class="token operator">*</span><span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>asyncIterator<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>asyncIdx <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>max<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token operator">=&gt;</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>asyncIdx<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">asyncCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">let</span> emitter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Emitter</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>

  <span class="token keyword">for</span> <span class="token keyword">await</span><span class="token punctuation">(</span><span class="token keyword">const</span> x <span class="token keyword">of</span> emitter <span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">asyncCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div></li></ul> <div class="custom-block warning"><p class="custom-block-title">⚠️ 注意</p> <p>Symbol.asyncIterator 是 ES2018 规范定义的，因此只有版本非常新的浏览器 支持它。</p></div> <h4 id="_6-symbol-hasinstance"><a href="#_6-symbol-hasinstance" class="header-anchor">#</a> 6.Symbol.hasInstance</h4> <ul><li>是一个方法</li> <li>该方法决定一个构造器对象是否认可一个对象是它的实例。 类似于 instanceof</li> <li>在 ES6 中，instanceof 操作符会使用 Symbol.hasInstance 函数来确定关系。以 Symbol. hasInstance 为键的函数会执行同样的操作，只是操作数对调了一下:<div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> f <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Foo<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>hasInstance<span class="token punctuation">]</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>f instance <span class="token keyword">of</span> Foo<span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre></div></li> <li>重新定义Symbol.hasInstance<div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Baz</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>hasInstance<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Baz</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
Baz<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>hasInstance<span class="token punctuation">]</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token comment">// false</span>
<span class="token comment">// 由于 instanceof 也会去原型上寻找 Symbol.hasInstance 所以也返回false</span>
b <span class="token keyword">instanceof</span> <span class="token class-name">Baz</span> <span class="token comment">// false</span>
</code></pre></div></li></ul> <h4 id="_7-symbol-isconcatspreadable"><a href="#_7-symbol-isconcatspreadable" class="header-anchor">#</a> 7.Symbol.isConcatSpreadable</h4> <ul><li><p>是一个值，值类型：Boolean</p></li> <li><p>该属性返回表示是否可以通过 <code>Array.prototype.concat()</code>方法打平其数组元素，覆盖 Symbol.isConcat- Spreadable 的值可以修改这个行为。默认情况下会被打平到已有的数组</p></li> <li><p>Symbol.isConcatSpreadable 真假值</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> arr1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'foo'</span><span class="token punctuation">]</span>
<span class="token keyword">var</span> arr2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'baz'</span><span class="token punctuation">]</span>
<span class="token comment">// 默认情况 值为 undefined ，自动被打平  等于 true的情况</span>
arr2<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>isConcatSpreadable<span class="token punctuation">]</span>  <span class="token comment">// undefined </span>
arr1<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>arr2<span class="token punctuation">)</span>   <span class="token comment">// ['foo','baz']</span>

<span class="token comment">// false 将追加的对象添加到末尾</span>
arr2<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>isConcatSpreadable<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">false</span>
arr<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>arr2<span class="token punctuation">)</span> <span class="token comment">// ['foo',['baz']]</span>
</code></pre></div></li> <li><p>支持合并 类数组对象</p> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token keyword">var</span> arrayLikeObj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token literal-property property">length</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token operator">:</span><span class="token string">'bar'</span><span class="token punctuation">}</span>
 <span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'foo'</span><span class="token punctuation">]</span>
 arr<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>arrayLikeObj<span class="token punctuation">)</span> <span class="token comment">// ['foo',{length:1,0:'bar'}]</span>
 arrayLikeObj<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>isConcatSpreadable<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span>
 arr<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>arrayLikeObj<span class="token punctuation">)</span> <span class="token comment">// ['foo','bar']</span>
</code></pre></div></li> <li><p>非类数组对象</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token literal-property property">a</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'foo'</span><span class="token punctuation">]</span>
arr<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token comment">// ['foo',{a:1}]</span>
obj<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>isConcatSpreadable<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span>
arr<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token comment">// ['foo']</span>
</code></pre></div></li></ul> <h4 id="_8-symbol-iterator"><a href="#_8-symbol-iterator" class="header-anchor">#</a> 8.Symbol.iterator</h4> <ul><li>是一个方法</li> <li>该方法返回对象默认迭代器，使用for - of遍历。
for - of 循环这样的语句结构会利用这函数执行迭代操作，他们会调用以 Symbol.iterator为键的函数，返回迭代器API对象，返回对象很多时候就是实现迭代对象的 Generator<div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Emitter</span><span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">max</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>idx <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>max <span class="token operator">=</span> max
  <span class="token punctuation">}</span>
  <span class="token operator">*</span><span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>idx <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span> max<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">yield</span> <span class="token keyword">this</span><span class="token punctuation">.</span>idx<span class="token operator">++</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">const</span> emitter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Emitter</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">of</span> emitter<span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token comment">// 0 .. 1 </span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 等同于以上for - of</span>
  <span class="token comment">/*for(let i = 0;i&lt;2;i++){
    console.log(emitter[Symbol.iterator]().next().value)
  }*/</span>
<span class="token punctuation">}</span>
<span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div></li></ul> <h4 id="_9-symbol-match"><a href="#_9-symbol-match" class="header-anchor">#</a> 9.Symbol.match</h4> <ul><li><p>是一个正则表达式方法</p></li> <li><p>该方法用正则表达式去匹配字符串。由 <code>String.prototype.match</code> 方法使用，此方法会使用以<code>Symbol.match</code> 为键的函数来对正则表达式求值。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">StringMatcher</span><span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>str <span class="token operator">=</span> str
  <span class="token punctuation">}</span>

  <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>match<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> target<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>str<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token string">'foostring'</span><span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StringMatcher</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
<span class="token string">'foostring'</span><span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StringMatcher</span><span class="token punctuation">(</span><span class="token string">'quex'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
</code></pre></div></li></ul> <h4 id="_10-symbol-replace"><a href="#_10-symbol-replace" class="header-anchor">#</a> 10.Symbol.replace</h4> <ul><li>是一个正则表达式方法</li> <li>该方法替换一个字符串中匹配的字符串，使用String.prototype.replace 方法使用，此方法会使用 Symbol.replace 为键的函数来对正则表达式求值。<div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">StringReplacer</span><span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>str <span class="token operator">=</span> str
  <span class="token punctuation">}</span>
  <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>replace<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span>replacement</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> target<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>str<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>replacement<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 将 strquereplace 中的 que 替换成 xxx</span>
<span class="token string">'strquereplace'</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StringReplacer</span><span class="token punctuation">(</span><span class="token string">'que'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'xxx'</span><span class="token punctuation">)</span>
</code></pre></div></li></ul> <h4 id="_11-symbol-search"><a href="#_11-symbol-search" class="header-anchor">#</a> 11.Symbol.search</h4> <ul><li><p>是一个正则表达式方法</p></li> <li><p>该方法返回字符串中匹配正则表达式的索引，使用String.prototype.search 方法来使用。 次方法会使用以Symbol.search 为键的函数来对正则表达式求值。</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">class</span> <span class="token class-name">StringSearcher</span><span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>str <span class="token operator">=</span> str<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>search<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> target<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>str<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token string">'fooString'</span><span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StringSearcher</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre></div></li></ul> <h4 id="_12-symbol-species"><a href="#_12-symbol-species" class="header-anchor">#</a> 12.Symbol.species</h4> <ul><li><p>是一个值</p></li> <li><p>该函数作为创建派生对象的构 造函数”。用于对内置类型实例方法的返回值暴露实例化派生对象的方法。用Symbol.species定义静态的获取器(getter)方法，可以覆盖新创建实例的原型定义:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">CustomArray</span> <span class="token keyword">extends</span> <span class="token class-name">Array</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token keyword">get</span> <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>species<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> Array
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CustomArray</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> derivedObj <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">v</span><span class="token operator">=&gt;</span>v<span class="token punctuation">)</span>
derivedObj <span class="token keyword">instanceof</span> <span class="token class-name">CustomArray</span> <span class="token comment">// false </span>
derivedObj <span class="token keyword">instanceof</span> <span class="token class-name">Array</span> <span class="token comment">// true </span>
</code></pre></div><p>以上代码通过数组的的内置方法map会创建一个派生对象 derivedObj，那么派生对象 derivedObj 的构造函数就是 Symbol.species 方法的返回值 所以 derivedObj 的构造函数是 Array，并不是 CustomArray。</p></li></ul> <h5 id="使用了此属性的方法"><a href="#使用了此属性的方法" class="header-anchor">#</a> 使用了此属性的方法</h5> <ul><li>Array.prototype.concat();</li> <li>Array.prototype.slice();</li> <li>Array.prototype.splice();</li> <li>Array.prototype.filter();</li> <li>Array.prototype.flat();</li> <li>Array.prototype.map();</li> <li>Array.prototype.flatMap();</li></ul> <h4 id="_13-symbol-split"><a href="#_13-symbol-split" class="header-anchor">#</a> 13.Symbol.split</h4> <ul><li>是一个正则表达式方法</li> <li>该方法在匹配正则表达式的索引位置拆分字符串。由Sting.prototype.split方法使用，可以重新定义Symbol.split</li> <li>RegExp默认定义了Symbol.split方法，接收正则参数，如果传入非RegExp对象类型，则会将参数强制转换成正则。</li> <li>可重新定义<div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">StringSplit</span><span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>str <span class="token operator">=</span> str<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>split<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> target<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>str<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token string">'foobarbaz'</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StringSplit</span><span class="token punctuation">(</span><span class="token string">'baz'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// ['foo','baz']</span>
</code></pre></div></li></ul> <h4 id="_14-symbol-toprimitive"><a href="#_14-symbol-toprimitive" class="header-anchor">#</a> 14.Symbol.toPrimitive</h4> <ul><li>是一个方法</li> <li>该方法将对象转换为相应的原始 值。由 ToPrimitive 抽象操作使用。<br>
很多内置操作都会尝试强制将对象转换为原始值，包括字符串、 数值和未指定的原始类型。</li> <li>可重新定义<div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>toPrimitive<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token parameter">hint</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>hint <span class="token operator">===</span> <span class="token string">'number'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token number">42</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>hint <span class="token operator">===</span> <span class="token string">'string'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token string">'hello'</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token operator">+</span>obj<span class="token punctuation">)</span> <span class="token comment">//  40 number</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>obj<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span> <span class="token comment">// hello  string</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token operator">+</span><span class="token string">''</span><span class="token punctuation">)</span> <span class="token comment">// true   default </span>
</code></pre></div></li></ul> <h5 id="tostring-和-valueof"><a href="#tostring-和-valueof" class="header-anchor">#</a> toString 和 valueOf</h5> <ul><li><p>toString()
该方法返回一个表示该对象的字符串</p></li> <li><p>valueOf()
该方法返回指定对象的原始值</p></li></ul> <h4 id="_15-symbol-tostringtag"><a href="#_15-symbol-tostringtag" class="header-anchor">#</a> 15.Symbol.toStringTag</h4> <ul><li>是一个字符串，用于创建对象的默认字符串描述</li> <li>由内置方法Object.prototype.toString()使用。<div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// Set(0) {}</span>
<span class="token keyword">class</span> <span class="token class-name">Foo</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">let</span> reg <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">abc</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span>

s<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>      <span class="token comment">// [object Set]</span>
Foo<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment">// class Foo {}</span>
reg<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment">// /abc/</span>

<span class="token keyword">class</span> <span class="token class-name">Bar</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>toStringTag<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Bar'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> bar <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
bar<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token comment">// [object Bar]</span>
bar<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>toStringTag<span class="token punctuation">]</span>   <span class="token comment">// Bar</span>
</code></pre></div></li></ul> <h4 id="_16-symbol-unscopables"><a href="#_16-symbol-unscopables" class="header-anchor">#</a> 16.Symbol.unscopables</h4> <ul><li>是一个对象，该对象所有的以及继承的属性，都会从关联对象with环境绑定中排除。</li> <li>设置Sybol.unscpables符号映射的属性的键值为true，就可以阻止该属性出现在with中<div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> o <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">foo</span><span class="token operator">:</span><span class="token string">'my name is o'</span>
<span class="token punctuation">}</span>
<span class="token keyword">with</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span> <span class="token comment">// my name is o</span>
<span class="token punctuation">}</span>
o<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>unscpables<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">foo</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
<span class="token keyword">with</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span> <span class="token comment">// ReferenceError</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/tengli1990/vuepress/edit/master/docs/books/javascript-ap.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">上次更新时间:</span> <span class="time">12/27/2020, 1:28:40 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/books/javascript-01.html" class="prev">
        《你不知道的javascript》上卷
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.95d8b7d8.js" defer></script><script src="/assets/js/2.78a10e41.js" defer></script><script src="/assets/js/75.45a0f288.js" defer></script>
  </body>
</html>
